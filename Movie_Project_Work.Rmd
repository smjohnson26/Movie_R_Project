---
title: "Movie Project Work"
author: "Steven Johnson"
date: "11/12/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
How are ratings affected by movie genre, movie duration, gender, or age group?


##Reading in Data and Libraries and removing un-needed columns
library(readr)
library("stringr")
library(dplyr)
USAMOVIES <- read.csv("C:/Users/balli/Documents/Movie_R_Project/USAMOVIES.csv")

ratings <- read.csv("C:/Users/balli/Documents/Movie_R_Project/IMDb ratings.csv")
names(ratings)<-str_replace_all(names(ratings), c("_" = "." , "," = "" ))
names(USAMOVIES)<-str_replace_all(names(USAMOVIES), c("_" = "." , "," = "" ))
USAMOVIES$budget <- substr(USAMOVIES$budget, start = 2, stop = 15)
USAMOVIES$budget <- as.numeric(USAMOVIES$budget)
USAMOVIES$usa.gross.income <- substr(USAMOVIES$usa.gross.income, start = 2, stop = 15)
USAMOVIES$usa.gross.income <- as.numeric(USAMOVIES$usa.gross.income)
USAMOVIES$worlwide.gross.income <- substr(USAMOVIES$worlwide.gross.income, start = 2, stop = 15)
USAMOVIES$worlwide.gross.income <- as.numeric(USAMOVIES$worlwide.gross.income)
USAMOVIES$profit <-(USAMOVIES$worlwide.gross.income- USAMOVIES$budget)
USAMOVIES<-USAMOVIES[!is.na(USAMOVIES$reviews.from.users)&!is.na(USAMOVIES$reviews.from.critics),]
USAMOVIES <- select(USAMOVIES,-c("metascore"))
USAMOVIES1 <- USAMOVIES

USAMOVIES1 <- select(USAMOVIES,-c("title","date.published","duration","director","writer",
"production.company","actors","description","Currency","currency","reviews.from.users",
"reviews.from.critics","votes"))
ratings <- select(ratings,c("imdb.title.id","weighted.average.vote","allgenders.0age.avg.vote",
"allgenders.18age.avg.vote","allgenders.30age.avg.vote","allgenders.45age.avg.vote",
"females.allages.avg.vote","males.allages.avg.vote"))
USAMOVIES1 <- merge(USAMOVIES1,ratings,by="imdb.title.id")


##Setting up Columns for Genres
USAMOVIES1["IsItHorror"]<- 0
USAMOVIES1["IsItRomance"] <- 0
USAMOVIES1["IsItAction"] <- 0
USAMOVIES1["IsItComedy"] <- 0
USAMOVIES1["IsItDrama"] <- 0
USAMOVIES1$IsItHorror[grep("Horror",USAMOVIES1$genre)] <- 1
USAMOVIES1$IsItRomance[grep("Romance",USAMOVIES1$genre)] <- 1
USAMOVIES1$IsItAction[grep("Action",USAMOVIES1$genre)] <- 1
USAMOVIES1$IsItComedy[grep("Comedy",USAMOVIES1$genre)] <- 1
USAMOVIES1$IsItDrama[grep("Drama",USAMOVIES1$genre)] <- 1

summary(USAMOVIES)


